version: '3.8'

services:
  dynamodb:
    image: amazon/dynamodb-local:latest
    container_name: jobmatch-dynamodb-test
    ports:
      - '8000:8000'
    environment:
      - AWS_ACCESS_KEY_ID=test
      - AWS_SECRET_ACCESS_KEY=test
      - AWS_DEFAULT_REGION=us-east-1
    command: -jar DynamoDBLocal.jar -sharedDb -inMemory
    healthcheck:
      test: ['CMD', 'curl', '-f', 'http://localhost:8000/']
      interval: 5s
      timeout: 3s
      retries: 10

  localstack:
    image: localstack/localstack:latest
    container_name: jobmatch-localstack-test
    ports:
      - '4566:4566'
    environment:
      - SERVICES=s3
      - DEBUG=0
      - AWS_ACCESS_KEY_ID=test
      - AWS_SECRET_ACCESS_KEY=test
      - AWS_DEFAULT_REGION=us-east-1
    healthcheck:
      test: ['CMD', 'curl', '-f', 'http://localhost:4566/']
      interval: 5s
      timeout: 3s
      retries: 10
